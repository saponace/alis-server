http:
  routers:
    catchall:
      entryPoints:
        - http
        - https
      middlewares:
        - https-redirect
      # Activate the router on any host requested
      rule: "HostRegexp(`{host:.+}`)"
      service: noop
      # tls:
      #   certresolver: le
      #   domains:
      #     - main: "%DOMAIN_NAME%"
      #       sans: ["*.%DOMAIN_NAME%"]


  middlewares:
    auth:
      forwardAuth:
        address: "http://auth:9091/api/verify?rd=https://auth.%DOMAIN_NAME%/"
        trustForwardHeader: true
        uthResponseHeaders:
          - "Remote-User"
          - "Remote-Groups"

    https-redirect:
      redirectScheme:
        scheme: https
        permanent: true


  services:
    noop:
      loadBalancer:
        servers:
          - url: localhost
